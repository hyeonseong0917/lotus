{"version":3,"file":"955.js","mappings":"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","sources":["webpack://loatus_web/./hooks/useInput.ts","webpack://loatus_web/./hooks/useSWRRetry.ts","webpack://loatus_web/./hooks/useTokenAxios.ts","webpack://loatus_web/./pages/PostWrite/index.tsx","webpack://loatus_web/./utils/fetcher.ts","webpack://loatus_web/./node_modules/react-cookie/es6/useCookies.js","webpack://loatus_web/./node_modules/react-cookie/es6/utils.js"],"sourcesContent":["import {useState, useCallback, ChangeEvent, Dispatch} from \"react\";\r\nimport React from \"react\";\r\n\r\ntype ReturnTypes<T = any> = [T, (e:any)=>void, Dispatch<React.SetStateAction<T>>];\r\nconst useInput = <T = any>(DefaultValue: T):ReturnTypes => {\r\n    const [value, setValue] = useState<T>(DefaultValue);\r\n    const onChangeValue = useCallback((e:any)=>{\r\n        setValue(e.target.value);\r\n    }, [setValue])\r\n    return [value, onChangeValue, setValue]\r\n}\r\n\r\nexport default useInput;","import useSWR from 'swr';\r\nimport { IUser } from '@typings/db';\r\nimport fetcher from '@utils/fetcher';\r\nimport axios from 'axios';\r\nimport { StateMutator } from 'swr-global-state';\r\n\r\nconst useSWRRetry = <T = any>(url: string | null, refreshToken: string) =>\r\n  useSWR<T | null>(\r\n    url && localStorage.getItem('accessToken') ? [url, localStorage.getItem('accessToken')] : null,\r\n    fetcher,\r\n    {\r\n      onErrorRetry: (err, key, config, revalidate, { retryCount }) => {\r\n        if (retryCount < 3) {\r\n          axios\r\n            .post(\r\n              process.env.REACT_APP_DB_HOST + '/auth/reissue',\r\n              {},\r\n              {\r\n                withCredentials: false,\r\n                headers: {\r\n                  Authorization: `Bearer ${localStorage.getItem('accessToken')}`,\r\n                  refreshToken: refreshToken,\r\n                },\r\n              },\r\n            )\r\n            .then((res) => {\r\n              localStorage.setItem('accessToken', res.data.data);\r\n            })\r\n            .catch((error) => error);\r\n        }\r\n      },\r\n    },\r\n  );\r\n\r\nexport default useSWRRetry;\r\n","import axios from 'axios';\r\nimport { StateMutator } from 'swr-global-state';\r\n\r\nconst useTokenAxios = (refreshToken: string) => {\r\n  const tokenAxios = axios.create({\r\n    headers: {\r\n      Authorization: `Bearer ${localStorage.getItem('accessToken')}`,\r\n    },\r\n  });\r\n  tokenAxios.interceptors.response.use(\r\n    (response) => response,\r\n    (error) => {\r\n      axios\r\n        .post(\r\n          process.env.REACT_APP_DB_HOST + '/auth/reissue',\r\n          {},\r\n          {\r\n            withCredentials: false,\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem('accessToken')}`,\r\n              refreshToken: refreshToken,\r\n            },\r\n          },\r\n        )\r\n        .then((res) => {\r\n          localStorage.setItem('accessToken', res.data.data);\r\n        })\r\n        .catch((error) => error);\r\n    },\r\n  );\r\n  return tokenAxios;\r\n};\r\n\r\nexport default useTokenAxios;\r\n","import React, { useCallback, useContext, useState } from 'react';\r\nimport { Form } from 'react-bootstrap';\r\nimport useInput from '@hooks/useInput';\r\nimport { toast } from 'react-toastify';\r\nimport { Navigate } from 'react-router-dom';\r\nimport useSWRRetry from '@hooks/useSWRRetry';\r\nimport { useCookies } from 'react-cookie';\r\nimport useTokenAxios from '@hooks/useTokenAxios';\r\nimport { useNavigate } from 'react-router';\r\nimport { Button } from '@mui/material';\r\n\r\nconst PostWrite = () => {\r\n  const navigate = useNavigate();\r\n  const accessToken = localStorage.getItem('accessToken');\r\n  const [token] = useCookies(['refreshToken']);\r\n  const { data: userData, error, mutate } = useSWRRetry(process.env.REACT_APP_DB_HOST + '/auth/my', token.refreshToken);\r\n  const [title, onChangeTitle, setTitle] = useInput('');\r\n  const [content, onChangeContent, setContent] = useInput('');\r\n  const [postSuccess, setPostSuccess] = useState(false);\r\n  const onSubmitPost = useCallback(\r\n    async (e: React.FormEvent<HTMLFormElement>) => {\r\n      e.preventDefault();\r\n      await useTokenAxios(token.refreshToken)\r\n        .post(\r\n          process.env.REACT_APP_DB_HOST + '/post/regist/',\r\n          {\r\n            title,\r\n            content,\r\n          },\r\n          {\r\n            withCredentials: false,\r\n            headers: {\r\n              Authorization: 'Bearer ' + accessToken,\r\n            },\r\n          },\r\n        )\r\n        .then((response) => {\r\n          if (response.data.code === 200) {\r\n            toast.success('글쓰기가 성공했습니다.', {\r\n              position: 'top-right',\r\n            });\r\n            setTitle('');\r\n            setContent('');\r\n            setPostSuccess(true);\r\n          } else {\r\n            toast.error('글쓰기가 실패했습니다.', {\r\n              position: 'top-right',\r\n            });\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          toast.error('글쓰기가 실패했습니다.', {\r\n            position: 'top-right',\r\n          });\r\n        });\r\n    },\r\n    [title, content],\r\n  );\r\n\r\n  if (!userData) {\r\n    toast.error('로그인이 필요합니다!', {\r\n      position: 'top-right',\r\n    });\r\n    return <Navigate to={'/board/lists'} replace />;\r\n  } else if (postSuccess) {\r\n    return <Navigate to={'/board/lists'} replace />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Form onSubmit={onSubmitPost} style={{ width: '600px' }}>\r\n        <Form.Group className=\"mb-3\" controlId=\"postForm.ControlInput\">\r\n          <Form.Label>Title</Form.Label>\r\n          <Form.Control\r\n            type=\"title\"\r\n            placeholder=\"제목을 입력해 주세요\"\r\n            value={title}\r\n            onChange={onChangeTitle}\r\n            required\r\n          />\r\n        </Form.Group>\r\n        <Form.Group className=\"mb-3\" controlId=\"postForm.ControlTextarea\">\r\n          <Form.Label>Content</Form.Label>\r\n          <Form.Control as=\"textarea\" rows={10} value={content} onChange={onChangeContent} required />\r\n        </Form.Group>\r\n        <Button onClick={() => navigate(-1)}>취소</Button>\r\n        <Button type=\"submit\">등록</Button>\r\n      </Form>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PostWrite;\r\n","import axios from 'axios';\r\n\r\nconst fetcher = async ([url, token]: string[]) => {\r\n  const res = await axios\r\n    .get(url, {\r\n      withCredentials: false,\r\n      headers: token\r\n        ? {\r\n            Authorization: `Bearer ${token}`,\r\n          }\r\n        : {},\r\n    })\r\n    .then((response) => response.data.data)\r\n    .catch((error) => null);\r\n  if (res === null) {\r\n    const error = new Error('errro');\r\n    throw error;\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport default fetcher;\r\n","import { useContext, useLayoutEffect, useState, useRef, useMemo } from 'react';\r\nimport CookiesContext from './CookiesContext';\r\nimport { isInBrowser } from './utils';\r\nexport default function useCookies(dependencies) {\r\n    var cookies = useContext(CookiesContext);\r\n    if (!cookies) {\r\n        throw new Error('Missing <CookiesProvider>');\r\n    }\r\n    var initialCookies = cookies.getAll();\r\n    var _a = useState(initialCookies), allCookies = _a[0], setCookies = _a[1];\r\n    var previousCookiesRef = useRef(allCookies);\r\n    if (isInBrowser()) {\r\n        useLayoutEffect(function () {\r\n            function onChange() {\r\n                var newCookies = cookies.getAll();\r\n                if (shouldUpdate(dependencies || null, newCookies, previousCookiesRef.current)) {\r\n                    setCookies(newCookies);\r\n                }\r\n                previousCookiesRef.current = newCookies;\r\n            }\r\n            cookies.addChangeListener(onChange);\r\n            return function () {\r\n                cookies.removeChangeListener(onChange);\r\n            };\r\n        }, [cookies]);\r\n    }\r\n    var setCookie = useMemo(function () { return cookies.set.bind(cookies); }, [cookies]);\r\n    var removeCookie = useMemo(function () { return cookies.remove.bind(cookies); }, [cookies]);\r\n    return [allCookies, setCookie, removeCookie];\r\n}\r\nfunction shouldUpdate(dependencies, newCookies, oldCookies) {\r\n    if (!dependencies) {\r\n        return true;\r\n    }\r\n    for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\r\n        var dependency = dependencies_1[_i];\r\n        if (newCookies[dependency] !== oldCookies[dependency]) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n","export function isInBrowser() {\r\n    return (typeof window !== 'undefined' &&\r\n        typeof window.document !== 'undefined' &&\r\n        typeof window.document.createElement !== 'undefined');\r\n}\r\n"],"names":["DefaultValue","useState","value","setValue","useCallback","e","target","url","refreshToken","useSWR","localStorage","getItem","fetcher","onErrorRetry","err","key","config","revalidate","retryCount","axios","process","withCredentials","headers","Authorization","then","res","setItem","data","catch","error","tokenAxios","interceptors","response","use","i","navigate","useNavigate","accessToken","token","useCookies","useSWRRetry","userData","mutate","useInput","title","onChangeTitle","setTitle","content","onChangeContent","setContent","postSuccess","setPostSuccess","onSubmitPost","preventDefault","useTokenAxios","post","code","toast","position","to","replace","onSubmit","style","width","className","controlId","type","placeholder","onChange","required","as","rows","onClick","Error","dependencies","cookies","useContext","CookiesContext","initialCookies","getAll","_a","allCookies","setCookies","previousCookiesRef","useRef","window","document","createElement","useLayoutEffect","newCookies","oldCookies","_i","dependencies_1","length","dependency","shouldUpdate","current","addChangeListener","removeChangeListener","useMemo","set","bind","remove"],"sourceRoot":""}