{"version":3,"file":"915.js","mappings":"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","sources":["webpack://loatus_web/./hooks/useInput.ts","webpack://loatus_web/./hooks/useTokenAxios.ts","webpack://loatus_web/./pages/PostEdit/index.tsx","webpack://loatus_web/./node_modules/react-cookie/es6/useCookies.js","webpack://loatus_web/./node_modules/react-cookie/es6/utils.js"],"sourcesContent":["import {useState, useCallback, ChangeEvent, Dispatch} from \"react\";\r\nimport React from \"react\";\r\n\r\ntype ReturnTypes<T = any> = [T, (e:any)=>void, Dispatch<React.SetStateAction<T>>];\r\nconst useInput = <T = any>(DefaultValue: T):ReturnTypes => {\r\n    const [value, setValue] = useState<T>(DefaultValue);\r\n    const onChangeValue = useCallback((e:any)=>{\r\n        setValue(e.target.value);\r\n    }, [setValue])\r\n    return [value, onChangeValue, setValue]\r\n}\r\n\r\nexport default useInput;","import axios from 'axios';\r\nimport { StateMutator } from 'swr-global-state';\r\n\r\nconst useTokenAxios = (refreshToken: string) => {\r\n  const tokenAxios = axios.create({\r\n    headers: {\r\n      Authorization: `Bearer ${localStorage.getItem('accessToken')}`,\r\n    },\r\n  });\r\n  tokenAxios.interceptors.response.use(\r\n    (response) => response,\r\n    (error) => {\r\n      axios\r\n        .post(\r\n          process.env.REACT_APP_DB_HOST + '/auth/reissue',\r\n          {},\r\n          {\r\n            withCredentials: false,\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem('accessToken')}`,\r\n              refreshToken: refreshToken,\r\n            },\r\n          },\r\n        )\r\n        .then((res) => {\r\n          localStorage.setItem('accessToken', res.data.data);\r\n        })\r\n        .catch((error) => error);\r\n    },\r\n  );\r\n  return tokenAxios;\r\n};\r\n\r\nexport default useTokenAxios;\r\n","import React, { useCallback, useContext, useEffect, useState } from 'react';\r\nimport { Form } from 'react-bootstrap';\r\nimport useInput from '@hooks/useInput';\r\nimport { toast } from 'react-toastify';\r\nimport { Navigate } from 'react-router-dom';\r\nimport useSWRRetry from '@hooks/useSWRRetry';\r\nimport { useCookies } from 'react-cookie';\r\nimport useTokenAxios from '@hooks/useTokenAxios';\r\nimport axios, { AxiosResponse } from 'axios';\r\nimport { useNavigate, useParams } from 'react-router';\r\nimport { APIItem, IPost } from '@typings/db';\r\nimport { Button } from '@mui/material';\r\n\r\nconst PostWrite = () => {\r\n  const navigate = useNavigate();\r\n  const params = useParams();\r\n  const accessToken = localStorage.getItem('accessToken');\r\n  const [token] = useCookies(['refreshToken']);\r\n  const { data: userData, error, mutate } = useSWRRetry(process.env.REACT_APP_DB_HOST + '/auth/my', token.refreshToken);\r\n  const [title, onChangeTitle, setTitle] = useInput('');\r\n  const [content, onChangeContent, setContent] = useInput('');\r\n  const [author, setAuthor] = useState('');\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(process.env.REACT_APP_DB_HOST + `/post/${params.id}`)\r\n      .then((res: AxiosResponse<APIItem<IPost[]>>) => {\r\n        console.log(res.data.data[0].fields);\r\n        setAuthor(res.data.data[0].fields.author);\r\n        setTitle(res.data.data[0].fields.title);\r\n        setContent(res.data.data[0].fields.content);\r\n      })\r\n      .catch((err) => {\r\n        toast.error(err.message);\r\n      });\r\n  }, []);\r\n\r\n  const onSubmitPost = useCallback(\r\n    async (e: React.FormEvent<HTMLFormElement>) => {\r\n      e.preventDefault();\r\n      await useTokenAxios(token.refreshToken)\r\n        .post(\r\n          process.env.REACT_APP_DB_HOST + `/post/edit/${params.id}/`,\r\n          {\r\n            title,\r\n            content,\r\n          },\r\n          {\r\n            withCredentials: false,\r\n            headers: {\r\n              Authorization: 'Bearer ' + accessToken,\r\n            },\r\n          },\r\n        )\r\n        .then((response) => {\r\n          if (response.data.code === 200) {\r\n            toast.success('글쓰기가 성공했습니다.', {\r\n              position: 'top-right',\r\n            });\r\n            setTitle('');\r\n            setContent('');\r\n            navigate(`/board/${params.id}`);\r\n          } else {\r\n            toast.error('글쓰기가 실패했습니다.', {\r\n              position: 'top-right',\r\n            });\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          toast.error('글쓰기가 실패했습니다.', {\r\n            position: 'top-right',\r\n          });\r\n        });\r\n    },\r\n    [title, content],\r\n  );\r\n\r\n  if (!userData) {\r\n    toast.error('권한이 없습니다', {\r\n      position: 'top-right',\r\n    });\r\n    return <Navigate to={'/board/lists'} replace />;\r\n  } else if (author && author !== userData.nickname) {\r\n    toast.error('권한이 없습니다', {\r\n      position: 'top-right',\r\n    });\r\n    return <Navigate to={'/board/lists'} replace />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Form onSubmit={onSubmitPost} style={{ width: '600px' }}>\r\n        <Form.Group className=\"mb-3\" controlId=\"postForm.ControlInput\">\r\n          <Form.Label>Title</Form.Label>\r\n          <Form.Control\r\n            type=\"title\"\r\n            placeholder=\"제목을 입력해 주세요\"\r\n            value={title}\r\n            onChange={onChangeTitle}\r\n            required\r\n          />\r\n        </Form.Group>\r\n        <Form.Group className=\"mb-3\" controlId=\"postForm.ControlTextarea\">\r\n          <Form.Label>Content</Form.Label>\r\n          <Form.Control as=\"textarea\" rows={10} value={content} onChange={onChangeContent} required />\r\n        </Form.Group>\r\n        <Button onClick={() => navigate(-1)}>취소</Button>\r\n        <Button type=\"submit\">등록</Button>\r\n      </Form>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PostWrite;\r\n","import { useContext, useLayoutEffect, useState, useRef, useMemo } from 'react';\r\nimport CookiesContext from './CookiesContext';\r\nimport { isInBrowser } from './utils';\r\nexport default function useCookies(dependencies) {\r\n    var cookies = useContext(CookiesContext);\r\n    if (!cookies) {\r\n        throw new Error('Missing <CookiesProvider>');\r\n    }\r\n    var initialCookies = cookies.getAll();\r\n    var _a = useState(initialCookies), allCookies = _a[0], setCookies = _a[1];\r\n    var previousCookiesRef = useRef(allCookies);\r\n    if (isInBrowser()) {\r\n        useLayoutEffect(function () {\r\n            function onChange() {\r\n                var newCookies = cookies.getAll();\r\n                if (shouldUpdate(dependencies || null, newCookies, previousCookiesRef.current)) {\r\n                    setCookies(newCookies);\r\n                }\r\n                previousCookiesRef.current = newCookies;\r\n            }\r\n            cookies.addChangeListener(onChange);\r\n            return function () {\r\n                cookies.removeChangeListener(onChange);\r\n            };\r\n        }, [cookies]);\r\n    }\r\n    var setCookie = useMemo(function () { return cookies.set.bind(cookies); }, [cookies]);\r\n    var removeCookie = useMemo(function () { return cookies.remove.bind(cookies); }, [cookies]);\r\n    return [allCookies, setCookie, removeCookie];\r\n}\r\nfunction shouldUpdate(dependencies, newCookies, oldCookies) {\r\n    if (!dependencies) {\r\n        return true;\r\n    }\r\n    for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\r\n        var dependency = dependencies_1[_i];\r\n        if (newCookies[dependency] !== oldCookies[dependency]) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n","export function isInBrowser() {\r\n    return (typeof window !== 'undefined' &&\r\n        typeof window.document !== 'undefined' &&\r\n        typeof window.document.createElement !== 'undefined');\r\n}\r\n"],"names":["DefaultValue","useState","value","setValue","useCallback","e","target","refreshToken","tokenAxios","axios","headers","Authorization","localStorage","getItem","interceptors","response","use","error","process","withCredentials","then","res","setItem","data","catch","i","navigate","useNavigate","params","useParams","accessToken","token","useCookies","useSWRRetry","userData","mutate","useInput","title","onChangeTitle","setTitle","content","onChangeContent","setContent","author","setAuthor","useEffect","id","console","log","fields","err","toast","message","onSubmitPost","preventDefault","useTokenAxios","post","code","position","nickname","to","replace","onSubmit","style","width","className","controlId","type","placeholder","onChange","required","as","rows","onClick","dependencies","cookies","useContext","CookiesContext","Error","initialCookies","getAll","_a","allCookies","setCookies","previousCookiesRef","useRef","window","document","createElement","useLayoutEffect","newCookies","oldCookies","_i","dependencies_1","length","dependency","shouldUpdate","current","addChangeListener","removeChangeListener","useMemo","set","bind","remove"],"sourceRoot":""}