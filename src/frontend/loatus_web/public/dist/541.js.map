{"version":3,"file":"541.js","mappings":"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","sources":["webpack://loatus_web/./hooks/useInput.ts","webpack://loatus_web/./hooks/useSWRRetry.ts","webpack://loatus_web/./pages/Channels/index.tsx","webpack://loatus_web/./utils/fetcher.ts"],"sourcesContent":["import {useState, useCallback, ChangeEvent, Dispatch} from \"react\";\r\nimport React from \"react\";\r\n\r\ntype ReturnTypes<T = any> = [T, (e:any)=>void, Dispatch<React.SetStateAction<T>>];\r\nconst useInput = <T = any>(DefaultValue: T):ReturnTypes => {\r\n    const [value, setValue] = useState<T>(DefaultValue);\r\n    const onChangeValue = useCallback((e:any)=>{\r\n        setValue(e.target.value);\r\n    }, [setValue])\r\n    return [value, onChangeValue, setValue]\r\n}\r\n\r\nexport default useInput;","import useSWR from 'swr';\r\nimport { IUser } from '@typings/db';\r\nimport fetcher from '@utils/fetcher';\r\nimport axios from 'axios';\r\nimport { StateMutator } from 'swr-global-state';\r\n\r\nconst useSWRRetry = <T = any>(url: string | null, refreshToken: string) =>\r\n  useSWR<T | null>(\r\n    url && localStorage.getItem('accessToken') ? [url, localStorage.getItem('accessToken')] : null,\r\n    fetcher,\r\n    {\r\n      onErrorRetry: (err, key, config, revalidate, { retryCount }) => {\r\n        if (retryCount < 3) {\r\n          axios\r\n            .post(\r\n              process.env.REACT_APP_DB_HOST + '/auth/reissue',\r\n              {},\r\n              {\r\n                withCredentials: false,\r\n                headers: {\r\n                  Authorization: `Bearer ${localStorage.getItem('accessToken')}`,\r\n                  refreshToken: refreshToken,\r\n                },\r\n              },\r\n            )\r\n            .then((res) => {\r\n              localStorage.setItem('accessToken', res.data.data);\r\n            })\r\n            .catch((error) => error);\r\n        }\r\n      },\r\n    },\r\n  );\r\n\r\nexport default useSWRRetry;\r\n","import React, { useCallback, useState } from 'react';\r\nimport { useCookies } from 'react-cookie';\r\nimport useSWRRetry from '@hooks/useSWRRetry';\r\nimport { Channel, Party } from '@typings/partyDB';\r\nimport { Outlet, useNavigate, useParams } from 'react-router';\r\nimport { Badge, Tab, Tabs } from '@mui/material';\r\nimport useInput from '@hooks/useInput';\r\nimport BottomNavigation from '@mui/material/BottomNavigation';\r\nimport BottomNavigationAction from '@mui/material/BottomNavigationAction';\r\nimport { IUser } from '@typings/db';\r\nimport MessageIcon from '@mui/icons-material/Message';\r\nimport axios from 'axios';\r\n\r\nconst Channels = () => {\r\n  const navigate = useNavigate();\r\n  const [token] = useCookies(['refreshToken']);\r\n  const {\r\n    data: userData,\r\n    error: userError,\r\n    mutate: userMutate,\r\n  } = useSWRRetry<IUser>(process.env.REACT_APP_DB_HOST + '/auth/my', token.refreshToken);\r\n  const params = useParams();\r\n  const {\r\n    data: channels,\r\n    error: channelsError,\r\n    mutate: channelsMutate,\r\n  } = useSWRRetry<Channel[]>(process.env.REACT_APP_DB_HOST + '/api/channels', token.refreshToken);\r\n  const [value, onChangeValue, setValue] = useInput(0);\r\n  const [navValue, onChangeNavValue, setNavValue] = useInput(0);\r\n  const {\r\n    data: myPartiesData,\r\n    error: myPartiesError,\r\n    mutate: myPartiesMutate,\r\n  } = useSWRRetry<Party[]>(\r\n    userData ? process.env.REACT_APP_DB_HOST + `/api/channels/${params.url}/parties/my/${userData.userId}` : null,\r\n    token.refreshToken,\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Tabs value={value} onChange={onChangeValue} aria-label=\"basic tabs example\">\r\n        {channels?.map((channel, key) => (\r\n          <Tab\r\n            label={channel.name}\r\n            id={`tab-${key}`}\r\n            key={key}\r\n            aria-controls={`tabpanel-${key}`}\r\n            onClick={() => {\r\n              setValue(key);\r\n              navigate(`/channels/${channel.url}/parties`);\r\n            }}\r\n          />\r\n        ))}\r\n      </Tabs>\r\n      <Outlet />\r\n      <BottomNavigation\r\n        showLabels\r\n        value={navValue}\r\n        onChange={(event, newValue) => {\r\n          setNavValue(newValue);\r\n        }}\r\n      >\r\n        {myPartiesData?.map((party, key) => (\r\n          <BottomNavigationAction\r\n            key={key}\r\n            label={party.name}\r\n            icon={\r\n              <Badge\r\n                badgeContent={\r\n                  <>\r\n                    {async () => {\r\n                      const res: number = await axios\r\n                        .get(process.env.REACT_APP_DB_HOST + `/api/channels/${params.url}/parties/${party.name}/unread`)\r\n                        .then((res) => res.data)\r\n                        .catch((err) => 0);\r\n                      return res;\r\n                    }}\r\n                  </>\r\n                }\r\n                color=\"primary\"\r\n              >\r\n                <MessageIcon />\r\n              </Badge>\r\n            }\r\n          />\r\n        ))}\r\n      </BottomNavigation>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Channels;\r\n","import axios from 'axios';\r\n\r\nconst fetcher = async ([url, token]: string[]) => {\r\n  const res = await axios\r\n    .get(url, {\r\n      withCredentials: false,\r\n      headers: token\r\n        ? {\r\n            Authorization: `Bearer ${token}`,\r\n          }\r\n        : {},\r\n    })\r\n    .then((response) => response.data.data)\r\n    .catch((error) => null);\r\n  if (res === null) {\r\n    const error = new Error('errro');\r\n    throw error;\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport default fetcher;\r\n"],"names":["DefaultValue","useState","value","setValue","useCallback","e","target","url","refreshToken","useSWR","localStorage","getItem","fetcher","onErrorRetry","err","key","config","revalidate","retryCount","axios","process","withCredentials","headers","Authorization","then","res","setItem","data","catch","error","i","navigate","useNavigate","token","useCookies","useSWRRetry","userData","params","mutate","useParams","channels","useInput","onChangeValue","navValue","setNavValue","userId","myPartiesData","onChange","map","channel","label","name","id","onClick","showLabels","event","newValue","party","icon","badgeContent","color","response","Error"],"sourceRoot":""}