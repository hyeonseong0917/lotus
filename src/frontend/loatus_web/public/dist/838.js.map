{"version":3,"file":"838.js","mappings":"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","sources":["webpack://loatus_web/./hooks/useInput.ts","webpack://loatus_web/./hooks/useTokenAxios.ts","webpack://loatus_web/./pages/Auth/index.tsx"],"sourcesContent":["import {useState, useCallback, ChangeEvent, Dispatch} from \"react\";\r\nimport React from \"react\";\r\n\r\ntype ReturnTypes<T = any> = [T, (e:any)=>void, Dispatch<React.SetStateAction<T>>];\r\nconst useInput = <T = any>(DefaultValue: T):ReturnTypes => {\r\n    const [value, setValue] = useState<T>(DefaultValue);\r\n    const onChangeValue = useCallback((e:any)=>{\r\n        setValue(e.target.value);\r\n    }, [setValue])\r\n    return [value, onChangeValue, setValue]\r\n}\r\n\r\nexport default useInput;","import axios from 'axios';\r\nimport { StateMutator } from 'swr-global-state';\r\n\r\nconst useTokenAxios = (refreshToken: string) => {\r\n  const tokenAxios = axios.create({\r\n    headers: {\r\n      Authorization: `Bearer ${localStorage.getItem('accessToken')}`,\r\n    },\r\n  });\r\n  tokenAxios.interceptors.response.use(\r\n    (response) => response,\r\n    (error) => {\r\n      axios\r\n        .post(\r\n          process.env.REACT_APP_DB_HOST + '/auth/reissue',\r\n          {},\r\n          {\r\n            withCredentials: false,\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem('accessToken')}`,\r\n              refreshToken: refreshToken,\r\n            },\r\n          },\r\n        )\r\n        .then((res) => {\r\n          localStorage.setItem('accessToken', res.data.data);\r\n        })\r\n        .catch((error) => error);\r\n    },\r\n  );\r\n  return tokenAxios;\r\n};\r\n\r\nexport default useTokenAxios;\r\n","import * as React from 'react';\r\nimport Box from '@mui/material/Box';\r\nimport Stepper from '@mui/material/Stepper';\r\nimport Step from '@mui/material/Step';\r\nimport StepLabel from '@mui/material/StepLabel';\r\nimport Button from '@mui/material/Button';\r\nimport Typography from '@mui/material/Typography';\r\nimport { FormControl, FormHelperText, Input, InputLabel, StepContent, TextField } from '@mui/material';\r\nimport { useCallback, useEffect, useState } from 'react';\r\nimport useTokenAxios from '@hooks/useTokenAxios';\r\nimport { AxiosResponse } from 'axios/index';\r\nimport { APIItem, lostarkInfo } from '@typings/db';\r\nimport { toast } from 'react-toastify';\r\nimport useToken from '@hooks/useToken';\r\nimport { useCookies } from 'react-cookie';\r\nimport useInput from '@hooks/useInput';\r\nimport CharacterSelect from '@components/CharacterSelect';\r\nimport useSWRRetry from '@hooks/useSWRRetry';\r\nimport { Navigate } from 'react-router-dom';\r\nimport { useNavigate } from 'react-router';\r\n\r\nexport default function Auth() {\r\n  const navigate = useNavigate();\r\n  const accessToken = localStorage.getItem('accessToken');\r\n  const [token, setToken] = useCookies(['refreshToken']);\r\n  const { data: userData, error, mutate } = useSWRRetry(process.env.REACT_APP_DB_HOST + '/auth/my', token.refreshToken);\r\n  const [activeStep, setActiveStep] = React.useState(0);\r\n  const [skipped, setSkipped] = React.useState(new Set<number>());\r\n  const [randomCode, setRandomCode] = useState('');\r\n  const steps = ['스토브 로그인', '소개글에 인증코드 게시', '인증하기'];\r\n  const [stoveUrl, onChangeStoveUrl, setStoveUrl] = useInput('');\r\n  const onClickCopyClipBoard = useCallback(async () => {\r\n    if (!randomCode) {\r\n      return;\r\n    }\r\n    try {\r\n      await navigator.clipboard.writeText(randomCode);\r\n      toast.success('인증코드가 클립보드에 복사되었습니다', {\r\n        position: 'top-right',\r\n      });\r\n    } catch (e) {\r\n      toast.error('복사에 실패했습니다.', {\r\n        position: 'top-right',\r\n      });\r\n    }\r\n  }, [randomCode]);\r\n  const onSubmitAuthInfo = useCallback(\r\n    (e: any) => {\r\n      e.preventDefault();\r\n      useTokenAxios(token.refreshToken)\r\n        .post(\r\n          process.env.REACT_APP_DB_HOST + '/auth/stove',\r\n          {\r\n            randomCode,\r\n            stoveUrl,\r\n          },\r\n          {\r\n            withCredentials: false,\r\n            headers: {\r\n              Authorization: 'Bearer ' + accessToken,\r\n            },\r\n          },\r\n        )\r\n        .then((response: AxiosResponse<APIItem<lostarkInfo[]>>) => {\r\n          if (response.data.code === 200) {\r\n            toast.success(response.data.message, {\r\n              position: 'top-right',\r\n            });\r\n          } else {\r\n            toast.error(response.data.message, {\r\n              position: 'top-right',\r\n            });\r\n            return;\r\n          }\r\n          mutate();\r\n          navigate('/select');\r\n        })\r\n        .catch((error) => {\r\n          toast.error('오류가 발생했습니다.\\n기술팀에 문의해주세요!', {\r\n            position: 'top-right',\r\n          });\r\n        });\r\n    },\r\n    [randomCode, stoveUrl],\r\n  );\r\n  const introduce = [\r\n    <>\r\n      <Typography sx={{ mt: 2, mb: 1 }}>스토브 사이트에서 로그인해주세요</Typography>\r\n      <Button onClick={() => window.open('https://www.onstove.com/')}>스토브 가기</Button>\r\n    </>,\r\n    <>\r\n      <Typography sx={{ mt: 2, mb: 1 }}>소개글에 아래의 인증코드를 게시해주세요</Typography>\r\n      <Input readOnly id=\"component-disabled\" value={randomCode || '값을 불러올 수 없습니다'} sx={{ color: 'gray' }} />\r\n      <Button onClick={onClickCopyClipBoard}>복사</Button>\r\n    </>,\r\n    <>\r\n      <Typography sx={{ mt: 2, mb: 1 }}>소개글을 게시한 타임라인 url을 입력하고 인증하기를 눌러주세요</Typography>\r\n      <form onSubmit={onSubmitAuthInfo}>\r\n        <FormControl fullWidth required>\r\n          <TextField onChange={onChangeStoveUrl} value={stoveUrl} variant={'filled'} />\r\n          <Button type=\"submit\">인증하기</Button>\r\n        </FormControl>\r\n      </form>\r\n    </>,\r\n  ];\r\n\r\n  useEffect(() => {\r\n    useTokenAxios(token.refreshToken)\r\n      .get(process.env.REACT_APP_DB_HOST + '/auth/randomcode', {\r\n        withCredentials: false,\r\n        headers: {\r\n          Authorization: 'Bearer ' + accessToken,\r\n        },\r\n      })\r\n      .then((response: AxiosResponse<APIItem<string>>) => {\r\n        setRandomCode(response.data.data);\r\n      })\r\n      .catch((error) => {\r\n        toast.error('인증번호를 불러올 수 없습니다.', {\r\n          position: 'top-right',\r\n        });\r\n      });\r\n  }, []);\r\n\r\n  const isStepOptional = (step: number) => {\r\n    return step === 1;\r\n  };\r\n\r\n  const isStepSkipped = (step: number) => {\r\n    return skipped.has(step);\r\n  };\r\n\r\n  const handleNext = () => {\r\n    let newSkipped = skipped;\r\n    if (isStepSkipped(activeStep)) {\r\n      newSkipped = new Set(newSkipped.values());\r\n      newSkipped.delete(activeStep);\r\n    }\r\n\r\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\r\n    setSkipped(newSkipped);\r\n  };\r\n\r\n  const handleBack = () => {\r\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\r\n  };\r\n\r\n  const handleSkip = () => {\r\n    if (!isStepOptional(activeStep)) {\r\n      // You probably want to guard against something like this,\r\n      // it should never occur unless someone's actively trying to break something.\r\n      throw new Error(\"You can't skip a step that isn't optional.\");\r\n    }\r\n\r\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\r\n    setSkipped((prevSkipped) => {\r\n      const newSkipped = new Set(prevSkipped.values());\r\n      newSkipped.add(activeStep);\r\n      return newSkipped;\r\n    });\r\n  };\r\n\r\n  const handleReset = () => {\r\n    setActiveStep(0);\r\n  };\r\n\r\n  if (!userData) {\r\n    return <Navigate to={'/'} />;\r\n  }\r\n  return (\r\n    <Box sx={{ minWidth: '1057px' }}>\r\n      <Stepper activeStep={activeStep}>\r\n        {steps.map((label, index) => {\r\n          const stepProps: { completed?: boolean } = {};\r\n          const labelProps: {\r\n            optional?: React.ReactNode;\r\n          } = {};\r\n          if (isStepSkipped(index)) {\r\n            stepProps.completed = false;\r\n          }\r\n          return (\r\n            <Step key={label} {...stepProps}>\r\n              <StepLabel {...labelProps}>\r\n                <Typography sx={{ color: 'black' }}>{label}</Typography>\r\n              </StepLabel>\r\n            </Step>\r\n          );\r\n        })}\r\n      </Stepper>\r\n      {activeStep === steps.length ? (\r\n        <React.Fragment>\r\n          <Typography sx={{ mt: 2, mb: 1 }}>모든 작업이 끝났습니다!</Typography>\r\n          <Box sx={{ display: 'flex', flexDirection: 'row', pt: 2 }}>\r\n            <Box sx={{ flex: '1 1 auto' }} />\r\n            <Button onClick={handleReset}>Reset</Button>\r\n          </Box>\r\n        </React.Fragment>\r\n      ) : (\r\n        <React.Fragment>\r\n          {introduce[activeStep]}\r\n          <Box sx={{ display: 'flex', flexDirection: 'row', pt: 2 }}>\r\n            <Button color=\"inherit\" disabled={activeStep === 0} onClick={handleBack} sx={{ mr: 1 }}>\r\n              Back\r\n            </Button>\r\n            <Box sx={{ flex: '1 1 auto' }} />\r\n            {isStepOptional(activeStep) && (\r\n              <Button color=\"inherit\" onClick={handleSkip} sx={{ mr: 1 }}>\r\n                Skip\r\n              </Button>\r\n            )}\r\n            {activeStep !== steps.length - 1 && <Button onClick={handleNext}>Next</Button>}\r\n          </Box>\r\n        </React.Fragment>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n"],"names":["DefaultValue","useState","value","setValue","useCallback","e","target","refreshToken","tokenAxios","axios","headers","Authorization","localStorage","getItem","interceptors","response","use","error","process","withCredentials","then","res","setItem","data","catch","i","Auth","navigate","useNavigate","accessToken","useCookies","token","useSWRRetry","userData","mutate","React","activeStep","setActiveStep","Set","skipped","setSkipped","randomCode","setRandomCode","steps","useInput","stoveUrl","onChangeStoveUrl","onClickCopyClipBoard","navigator","clipboard","writeText","toast","position","onSubmitAuthInfo","preventDefault","useTokenAxios","post","code","message","introduce","sx","mt","mb","onClick","window","open","readOnly","id","color","onSubmit","fullWidth","required","onChange","variant","type","useEffect","get","isStepOptional","step","isStepSkipped","has","minWidth","map","label","index","stepProps","labelProps","completed","key","length","display","flexDirection","pt","flex","disabled","prevActiveStep","mr","Error","prevSkipped","newSkipped","values","add","delete","to"],"sourceRoot":""}